<% content_for :title, "Articles" %>

<div id="articles">
      
  <div class="row justify-content-center mx-0 px-0">
    <div class="col-12 col-sm-6 mb-4">
    
      <% if notice %>
        <p class="my-3">
          <span class="d-block notice" style="color: red"> <strong> <%= notice %> </strong> </span>
        </p>
      <% end %>

      <% if @comment && @comment.errors.any? %>
        <div id="error_explanation" class="mx-2"  style="color: red">
          <h2><%= pluralize(@comment.errors.count, "Error: ") %> No es posible guardar comentario</h2>
          <ul>
            <% @comment.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <%= render @article %>

      <%= form_with(model: [ @article, Comment.new ]) do |form| %>

          <div class="my-2 w-100">
            <div class="form-group my-2">
              <%= form.label :content, "Ingresa tu comentario", class: "col-12"%>
              <%= form.text_area :content, required: true, class: "form-control ps-2 col-12 border rounded-2", rows: 3 %>
            </div>
            <%= form.submit "Comentar", class: "btn btn-primary" %>
          </div>

      <% end %>

      <br>
      <% if @article.comments.count > 0%>
        <h2> Comentarios </h2>
      <% end %>

      <% @article.comments.order(created_at: :desc).each do |comment| %> <!-- Itero sobre los comentarios de cada article -->
        <div class="my-1 border rounded-2">
            <%= comment.created_at.strftime("%d-%m-%Y %H:%M") %> <br>

            <div class="flex-grow-1 ms-2"> 
              <% if comment.user %>
                 <strong>Usuario   </strong> : <%= comment.user.name %>
              <% else %>
                  <strong> Comentario An√≥nimo </strong>
              <% end %>
              <br>
              <%= comment.content %>
            </div>

        </div>
      <% end %>

      <br>
      <%= link_to "Regresar", articles_path, class: "btn btn-primary" %>
    
    </div>
  </div>
</div>
